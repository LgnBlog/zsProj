(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4359c9cc"],{"059a":function(e,t,a){"use strict";var n=a("9a88"),o=a.n(n);o.a},"296d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"1"===e.$root.themeHomeChange?"operationLog_light":"operationLog",attrs:{id:"operationLog"}},[a("div",{staticClass:"header"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("操作日志")]),a("div",{staticStyle:{"font-size":"12px","font-weight":"500"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-printer",plain:"1"===e.$root.themeHomeChange,loading:e.exportLoading},on:{click:e.exportExcel}},[e._v(" 导出日志 ")])],1)]),a("el-form",{staticClass:"selectBox",attrs:{inline:!0,model:e.params}},[a("span",[a("el-form-item",{attrs:{label:"操作时间: ",prop:"operationDate"}},[a("el-date-picker",{attrs:{size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},model:{value:e.params.operationDate,callback:function(t){e.$set(e.params,"operationDate",t)},expression:"params.operationDate"}})],1)],1),a("span",{staticStyle:{float:"right"}},[a("el-form-item",[a("bda-search-input",{attrs:{placeholder:"请输入关键字",size:"mini"},on:{search:function(t){return e.getTableList(!0)},clear:function(t){return e.getTableList(!0)}},model:{value:e.params.keyword,callback:function(t){e.$set(e.params,"keyword",t)},expression:"params.keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.getTableList(!0)}}},[e._v(" 查询 ")])],1)],1)]),a("div",{staticClass:"content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"light",height:e.tableHeight,"row-key":e.rowKeyInit,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"operId",label:"日志编号",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"title",label:"系统模块","min-width":"120",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"operatorType",label:"操作类型","min-width":"80",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.tableOption["type"][t.row.operatorType])+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"operatorDesc",label:"操作说明","min-width":"180",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"operName",label:"操作人员",width:"100",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"operIp",label:"IP地址",width:"150",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"deptName",label:"所属部门","min-width":"100",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"操作状态",width:"85",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:{cursor:"pointer",color:t.row.status?"#67C23A":"#e63d1b","font-weight":"bold"}},[e._v("\n            "+e._s(t.row.status?"正常":"异常")+"\n          ")])]}}])}),a("el-table-column",{attrs:{prop:"operTime",label:"操作时间",width:"160",align:"center","show-overflow-tooltip":""}})],1),a("el-pagination",{attrs:{"current-page":e.params.currentPage,"page-sizes":[10,50,100,200],"page-size":e.params.pageSize,background:"",layout:"prev, pager, next, sizes, jumper, total",total:e.params.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},o=[],i=(a("7514"),a("ac6a"),a("fe66")),r=a("db49"),l=a("bc3a"),s=a.n(l),c={name:"operationLog",components:{},mixins:[i["a"]],props:{orderId:{type:String,default:function(){return""}}},data:function(){return{exportLoading:!1,tableHeight:window.innerHeight-240,detailInfo:[],params:{pageSize:10,currentPage:1,total:0,operationDate:[]},defectStatus:"",multipleSelection:[],tableLoading:!1,tableOption:{type:{0:"其它",1:"新增",2:"修改",3:"删除",4:"授权",5:"上传",6:"下载",7:"导出",8:"导入",9:"强退",10:"生成代码",11:"清空数据"}},tableData:[]}},watch:{"params.operationDate":{handler:function(e){null===e&&(this.params.operationDate=[])},immediate:!0}},created:function(){this.initData()},mounted:function(){},methods:{initData:function(){this.getTableList()},rowKeyInit:function(e){return e.defectId},getTableList:function(e){var t=this;e&&this.setPages();var a={defectStatus:this.params.defectStatus,current:this.params.currentPage,size:this.params.pageSize,beginTime:this.params.operationDate[0],endTime:this.params.operationDate[1],keyword:this.params.keyword,mark:""};this.tableData=[],this.tableLoading=!0,this.getOperlogList(a).then((function(e){e?(t.tableData=e.rows,t.setPages(e.current,e.size,e.records)):t.setPages()})).finally((function(){t.tableLoading=!1}))},toggleSelection:function(e){var t=this;e?e.forEach((function(e){window.console.log(e,t.tableData),t.$refs.multipleTable.toggleRowSelection(t.tableData.find((function(t){return t.defectId===e})))})):this.$refs.multipleTable.clearSelection()},setPages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.params["pageSize"]=t,this.params["currentPage"]=e,this.params["total"]=a},searchTableNames:function(e){var t=this,a="";return e.forEach((function(e){a+=t.tableData.find((function(t){return t.defectId==e.defectId})).ruleName+","})),a},handleSizeChange:function(e){this.params.currentPage=1,this.params.pageSize=e,this.getTableList()},handleCurrentChange:function(e){this.params.currentPage=e,this.getTableList()},handleSelectionChange:function(e){this.multipleSelection=e},selectInit:function(e){var t=!0;return 0!=this.multipleSelection.length&&(t=this.multipleSelection.some((function(t){if(t.defectStatus===e.defectStatus&&5!==e.defectStatus)return!0}))),t},exportExcel:function(){var e=this,t="/operlog/export",a={current:this.params.currentPage,size:this.params.pageSize,beginTime:this.params.operationDate[0],endTime:this.params.operationDate[1],keyword:this.params.keyword,mark:""};this.exportLoading=!0,s()({method:"POST",url:r["b"]+t,data:a,headers:{"Content-Type":"application/json;charset=UTF-8"},responseType:"blob"}).then((function(e){var t=e.data,a=new Blob([t]),n="操作日志.xlsx";if("download"in document.createElement("a")){var o=document.createElement("a");o.download=n,o.style.display="none",o.href=URL.createObjectURL(a),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)}else navigator.msSaveBlob(a,n)})).finally((function(){e.exportLoading=!1})).catch((function(){}))}}},p=c,u=(a("059a"),a("6c34"),a("2877")),d=Object(u["a"])(p,n,o,!1,null,"77107eed",null);t["default"]=d.exports},"6c34":function(e,t,a){"use strict";var n=a("7ffe"),o=a.n(n);o.a},"7ffe":function(e,t,a){},"9a88":function(e,t,a){},fe66:function(e,t,a){"use strict";var n=a("db49"),o=a("ab3e"),i=n["b"]+"/operlog/list";function r(e){return Object(o["a"])({method:"POST",headers:{"Content-Type":"application/json;charset=utf8"},data:e,url:i})}var l=n["b"]+"/operlog/login/list";function s(e){return Object(o["a"])({method:"POST",headers:{"Content-Type":"application/json;charset=utf8"},data:e,url:l})}t["a"]={data:function(){return{systemLog:{list:[],page:null,limit:null,total:0,model:null}}},methods:{getOperlogList:function(e){return r(e).then((function(e){return e}))},getLoginlogList:function(e){return s(e).then((function(e){return e}))}}}}}]);
//# sourceMappingURL=chunk-4359c9cc.4f08749b.js.map