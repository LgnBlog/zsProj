(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74e76712","chunk-2b42f874"],{"088e":function(e,t,o){"use strict";var n=o("80f2"),i=o.n(n);i.a},1809:function(e,t,o){},"5d0e":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("bda-dialog",{attrs:{visible:e.dialogVisible,modal:!1,"close-on-click-modal":!1,"show-close":!1,title:"历史文件及版本"},on:{cancel:e.closeDialog}},[o("div",{class:"1"===e.$root.themeHomeChange?"dialogBoxLs":"dialogBox"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.fileTableLoading,expression:"fileTableLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.tableData,height:"320"}},[o("el-table-column",{attrs:{label:"文档名称",prop:"documentName"}}),o("el-table-column",{attrs:{label:"版本号",prop:"version",width:"80"}}),o("el-table-column",{attrs:{label:"上传用户",prop:"uploadUser",width:"120"}}),o("el-table-column",{attrs:{label:"上传时间",prop:"uploadTime"}}),o("el-table-column",{attrs:{label:"是否最新版本",width:"130",prop:"isLatest"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s("1"===t.row.isLatest?"是":"否")+"\n                ")]}}])}),o("el-table-column",{attrs:{label:"说明",width:"200",prop:"comment"}}),o("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticStyle:{"margin-right":"10px",color:"#66b9ff",cursor:"pointer"},on:{click:function(o){return e.dowmFile(t.row)}}},[e._v("下载")])]}}])})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("bda-button",{attrs:{bdatype:"defualt"},on:{click:e.closeDialog}},[e._v("关闭")])],1)])},i=[],l=o("8986"),a=o("db49"),s={name:"historyDoc",mixins:[l["a"]],data:function(){return{fileTableLoading:!1,dialogVisible:!1,tableData:[],downUrl:a["b"]+"/knowledge/file/download"}},mounted:function(){},methods:{closeDialog:function(){this.dialogVisible=!1},getHistoryList:function(e){var t=this;this.fileTableLoading=!0,this.historyVersionList({historyDocumentId:e.documentId}).then((function(e){t.tableData=e})).finally((function(){t.fileTableLoading=!1}))},dowmFile:function(e){window.location.href=this.downUrl+"?documentId="+e.documentId+"&historyDocumentId="+e.documentHistoryId}}},c=s,r=(o("088e"),o("2877")),d=Object(r["a"])(c,n,i,!1,null,"a9e39dd0",null);t["default"]=d.exports},7276:function(e,t,o){"use strict";var n=o("1809"),i=o.n(n);i.a},"80f2":function(e,t,o){},"88c8":function(e,t,o){"use strict";var n=o("90e6"),i=o.n(n);i.a},"90e6":function(e,t,o){},"95f4":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("bda-dialog",{class:"1"===e.$root.themeHomeChange?"dialogBoxL":"",attrs:{width:"80%","show-close":!1,visible:e.dialogVisible,modal:!1,"close-on-click-modal":!1,title:"文件及版本管理"},on:{cancel:e.closeDialog}},[o("div",{staticClass:"dialogBox"},[o("div",{staticClass:"zskClass"},[o("span",{staticClass:"name",attrs:{title:e.knowledgeName}},[e._v("知识库名称："+e._s(e.knowledgeName))]),o("span",{staticStyle:{color:"#ffffff"}},[e._v("版本号：")]),o("bda-input",{staticClass:"bbh_input",attrs:{clearable:"",placeholder:"版本号"},on:{change:e.handleZskVersion},model:{value:e.zskVersion,callback:function(t){e.zskVersion=t},expression:"zskVersion"}})],1),o("el-upload",{staticClass:"upload-demo",attrs:{data:e.fileData,name:"files",action:e.fileUrl,"on-change":e.handleChange,"before-upload":e.beforeAvatarUpload,"on-success":e.handleAvatarSuccess,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.fileTableLoading,expression:"fileTableLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.tableData,height:"320"}},[o("el-table-column",{attrs:{label:"文档名称",prop:"documentName"}}),o("el-table-column",{attrs:{label:"版本号",width:"120",prop:"version"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("bda-input",{attrs:{clearable:"",placeholder:"请输入"},on:{change:function(o){return e.handleVersion(t.row)}},model:{value:t.row.version,callback:function(o){e.$set(t.row,"version",o)},expression:"scope.row.version"}})]}}])}),o("el-table-column",{attrs:{label:"上传用户",width:"90",prop:"uploader"}}),o("el-table-column",{attrs:{label:"最新上传时间",width:"130",prop:"uploadTime"}}),o("el-table-column",{attrs:{label:"是否最新版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(1===t.row.isLatest?"是":"否")+"\n          ")]}}])}),o("el-table-column",{attrs:{label:"说明",width:"190",prop:"comment"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("bda-input",{attrs:{clearable:"",placeholder:"请输入"},on:{change:function(o){return e.handleComment(t.row)}},model:{value:t.row.comment,callback:function(o){e.$set(t.row,"comment",o)},expression:"scope.row.comment"}})]}}])}),o("el-table-column",{attrs:{label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticStyle:{"margin-right":"10px",color:"#66b9ff",cursor:"pointer"},on:{click:function(o){return e.dowmFile(t.row)}}},[e._v("下载")]),o("span",{staticStyle:{"margin-right":"10px",color:"#66b9ff",cursor:"pointer"},on:{click:function(o){return e.uploadVs(t.row)}}},[e._v("上传最新版本")]),o("span",{staticStyle:{"margin-right":"10px",color:"#66b9ff",cursor:"pointer"},on:{click:function(o){return e.queryHistoryV(t.row)}}},[e._v("历史版本查看")]),o("span",{staticStyle:{display:"inline-block",cursor:"pointer",color:"#66b9ff"},on:{click:function(o){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("bda-button",{attrs:{bdatype:"defualt"},on:{click:e.closeDialog}},[e._v("关闭")])],1)],1),o("history-doc",{ref:"historyVersion"}),e.showFileUp?o("file-upload",{ref:"fileUpload",attrs:{url:"/knowledge/file/upload",fileData:e.historyFileData},on:{upLoadSuccess:e.fileUpSuccess}}):e._e()],1)},i=[],l=o("8986"),a=o("5d0e"),s=o("cae2"),c=o("db49"),r={mixins:[l["a"]],components:{historyDoc:a["default"],fileUpload:s["a"]},data:function(){return{hidden:"",dialogVisible:!1,radioValue:"",tableData:[],knowledgeId:"",knowledgeName:"",zskVersion:"",documentId:"",fileData:{documentTypeName:"",knowledgeId:""},historyFileData:{documentTypeName:"",documentId:"",knowledgeId:""},showFileUp:!1,downUrl:c["b"]+"/knowledge/file/download",fileUrl:c["b"]+"/knowledge/file/upload",fileList:[],fileTableLoading:!1}},mounted:function(){},methods:{openDialog:function(e){this.fileData.documentTypeName=e.knowledgeType||"",this.fileData.knowledgeId=e.knowledgeId||"",this.zskVersion=e.version||"",this.knowledgeName=e.knowledgeName||"",this.documentId=e.documentId||"",this.historyFileData.documentTypeName=e.knowledgeType||"",this.knowledgeId=e.knowledgeId,this.getList(),!1===this.dialogVisible&&(this.dialogVisible=!0)},fileUpSuccess:function(){this.getList()},getList:function(){var e=this;this.fileTableLoading=!0,this.getVersionList({knowledgeId:this.knowledgeId}).then((function(t){e.tableData=t})).finally((function(){e.fileTableLoading=!1}))},closeDialog:function(){this.$parent.getDocumentQuery(),this.$parent.showVs=!1,this.dialogVisible=!1},sureDialog:function(){this.dialogVisible=!1},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.versionDelete({documentId:e.documentId,filePath:e.filePath,knowledgeId:e.knowledgeId}).then((function(e){e&&(t.$message({type:"success",message:"删除成功!"}),t.getList())})).finally((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleAvatarSuccess:function(e){e&&(this.$message.success("上传成功"),this.getList(),this.$parent.getDocumentQuery())},beforeAvatarUpload:function(){return!0},handleChange:function(e,t){this.fileList=t.slice(-1)},dowmFile:function(e){window.location.href=this.downUrl+"?documentId="+e.documentId},handleVersion:function(e){e.version?this.versionUpdate({documentId:e.documentId,documentVersion:e.version}).then((function(){})).finally((function(){})):this.$message.warning("请输入版本号")},handleComment:function(e){this.versionUpdate({comment:e.comment,documentId:e.documentId}).then((function(){})).finally((function(){}))},queryHistoryV:function(e){this.$refs.historyVersion.dialogVisible=!0,this.$refs.historyVersion.getHistoryList(e)},handleZskVersion:function(){this.versionUpdates({knowledgeId:this.knowledgeId,knowledgeVersion:this.zskVersion}).then((function(){})).finally((function(){}))},uploadVs:function(e){var t=this;this.showFileUp=!0,this.$nextTick((function(){t.historyFileData.documentId=e.documentId||"",t.historyFileData.knowledgeId=e.knowledgeId||"",t.$refs.fileUpload.dialogVisible=!0}))}}},d=r,u=(o("7276"),o("2877")),f=Object(u["a"])(d,n,i,!1,null,"97c680d2",null);t["default"]=f.exports},cae2:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("bda-dialog",{attrs:{visible:e.dialogVisible,modal:!0,"show-close":!1,"close-on-click-modal":!1,title:"历史文件及版本"},on:{cancel:e.closeDialog}},[o("div",{staticClass:"dialogBox"},[o("el-upload",{staticClass:"upload-demo",attrs:{drag:"",data:e.fileData,name:e.fileName,action:e.fileUrl,"on-change":e.handleChange,"before-upload":e.beforeAvatarUpload,"on-success":e.handleAvatarSuccess,"file-list":e.fileList}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),o("em",[e._v("点击上传")])])])],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("bda-button",{attrs:{bdatype:"defualt"},on:{click:e.closeDialog}},[e._v("关闭")])],1)])},i=[],l=o("8986"),a=o("db49"),s={name:"historyDoc",mixins:[l["a"]],props:{url:{type:String,default:function(){return""}},fileName:{type:String,default:function(){return"files"}},fileData:{type:Object,default:function(){return null}}},data:function(){return{dialogVisible:!1,fileUrl:null,fileList:[]}},mounted:function(){this.fileUrl=a["b"]+this.url},methods:{closeDialog:function(){this.dialogVisible=!1,this.$parent.showFileUp=!1},handleAvatarSuccess:function(e){e&&(this.$message.success("上传成功"),this.$emit("upLoadSuccess",e))},beforeAvatarUpload:function(){return!0},handleChange:function(e,t){this.fileList=t.slice(-1)}}},c=s,r=(o("88c8"),o("2877")),d=Object(r["a"])(c,n,i,!1,null,"94ef67d8",null);t["a"]=d.exports}}]);
//# sourceMappingURL=chunk-74e76712.ae0ea1c9.js.map